def _get_protocol(pkt):
    eth_type = pkt.get_protocols(ryu.ofproto.ether.ETH_TYPE_IP)
    if eth_type:
        ip_proto = pkt.get_protocols(ryu.ofproto.inet.IPPROTO_TCP)
        if ip_proto:
            return 'TCP'
        else:
            ip_proto = pkt.get_protocols(ryu.ofproto.inet.IPPROTO_UDP)
            if ip_proto:
                return 'UDP'
            else:
                ip_proto = pkt.get_protocols(ryu.ofproto.inet.IPPROTO_ICMP)
                if ip_proto:
                    return 'ICMP'
    else:
        eth_type = pkt.get_protocols(ryu.ofproto.ether.ETH_TYPE_IPV6)
        if eth_type:
            ip_proto = pkt.get_protocols(ryu.ofproto.inet.IPPROTO_TCP)
            if ip_proto:
                return 'TCP'
            else:
                ip_proto = pkt.get_protocols(ryu.ofproto.inet.IPPROTO_UDP)
                if ip_proto:
                    return 'UDP'
                else:
                    ip_proto = pkt.get_protocols(ryu.ofproto.inet.IPPROTO_ICMP)
                    if ip_proto:
                        return 'ICMP'
    return 'Other'
